[[N07 Google Driveをデータベース・サーバー代わりにできる？PDFビューアーWebアプリ開発のポイント]]

## はじめに
今回の質問は「PDFファイルを閲覧できるWebアプリに、レイヤーを追加して上からメモ書きできるようにしたい」というものです。これは**ハウツー系の記事**に分類されます。本記事では、実現可能性と実装方法の選択肢を整理します。

## 実現の可否
結論から言うと **実現可能** です。ただし「PDFに直接編集を書き込む」のではなく、**閲覧用のPDF表示レイヤーの上に、別レイヤーとしてメモや注釈を書き加える方式**が一般的です。

## 実現方法
### 1. PDF.js + Canvasを利用
- **PDF.js**でPDFをCanvasに描画
- その上に**透明なCanvas要素**を重ねる
- マウスやタッチ操作でメモ書きを描画
- 保存時は「PDF本体」と「メモレイヤー」を分離して管理

### 2. Annotationライブラリを利用
- `pdf-annotate.js`や`PDFTron WebViewer`などを利用すると、注釈やコメントを標準化された形式（PDF Annotation）で追加可能
- メモ内容をPDF内に埋め込むことも可能（ただし埋め込みはライブラリ依存）

### 3. SVGやHTMLレイヤーを使う
- PDFは背景としてCanvasに表示
- 上から透明な`<div>`やSVGを配置してテキストや手書きメモを重ねる
- 編集や削除が容易で柔軟性が高い

## 保存方法の選択肢
### 単独保存（簡易方式）
- メモはJSONや独自形式で保存
- 再表示時にPDFの上に読み込んで描画
- メリット：処理が軽く実装が簡単
- デメリット：他のPDFビューアーではメモが見えない

### PDFに埋め込み（高度方式）
- PDFのアノテーション仕様に沿って書き込み
- Adobe Acrobatなど他ソフトでもメモが閲覧可能
- デメリット：実装難易度が高い、専用ライブラリが必要

## 実装ステップ例（Canvas重ね方式）
1. PDF.jsでPDFをCanvasに描画
2. `<canvas id="annotation-layer">`を上に配置（透明背景）
3. JavaScriptでマウス/タッチ操作を検知し、線や文字を描画
4. メモデータをJSONとして保存
5. 再読み込み時にPDF描画後、JSONデータを反映

## まとめ
- **PDFの上にメモレイヤーを重ねることは可能**
- 実装は「外部ライブラリ利用」か「Canvas/SVGで自作」の2パターン
- 保存は「別データ管理」か「PDFに埋め込み」の2種類がある
- 簡単に実現したいなら「Canvas重ね方式＋JSON保存」が現実的

※この記事はChatGPTの回答を基に作成しています。

[[N09 Canvas重ね方式＋JSON保存で実現するPDFメモビューアー構成案]]