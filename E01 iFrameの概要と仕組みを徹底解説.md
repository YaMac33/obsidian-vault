[[D03 PDFファイルをiFrameで埋め込む方法]]

## iFrameとは？
iFrame（Inline Frame）は、HTML文書内に別のHTML文書を埋め込むために使用されるHTML要素です。これにより、親ページ（ホストページ）の中に子ページ（埋め込まれたページ）を独立したウィンドウのように表示できます。

## iFrameの仕組み
iFrameは、親ページとは異なるブラウジングコンテキストで動作します。具体的には、以下のメカニズムで成り立っています。

### 独立したHTMLドキュメント
- iFrameは、`src`属性で指定されたURLの内容を、親ページとは独立した別のHTMLドキュメントとして読み込み、表示します。  
- 親ページのCSSやJavaScriptの影響をほとんど受けずに、埋め込まれたページが独自のスタイルやスクリプトで描画されます。

### サンドボックス化
- ブラウザは、セキュリティ上の理由から、iFrameの中身を親ページから隔離します。  
- デフォルトでは、親ページのJavaScriptがiFrameの中身に直接アクセスすることは許可されておらず、逆にiFrame内のJavaScriptが親ページにアクセスすることも制限されています。  
- これにより、悪意のあるサイトがiFrameを通じて親ページのデータを盗んだり、ユーザーをだましたりするのを防ぎます。

### クロスドメイン通信
- 親ページとiFrameの間で安全にデータをやり取りする必要がある場合、`postMessage()`メソッドが使われます。  
- このAPIは、異なるドメイン間でもメッセージを送受信できる標準的な方法を提供します。  
- 例えば、親ページからiFrame内のコンテンツにコマンドを送ったり、iFrameから親ページに完了通知を返したりすることが可能になります。

## iFrameの利用例
iFrameは以下のような場面で利用されます。

- 外部コンテンツの埋め込み（YouTube動画、Googleマップ、SNS投稿など）  
- 広告の表示（広告スクリプトが主要コンテンツを汚染するのを防ぐ）  
- 決済フォームの表示（外部サービスを安全に利用するため）

## iFrameの注意点

### セキュリティ
- `sandbox`属性を使うことで、iFrameの権限をさらに細かく制御できます。  

### パフォーマンス
- 外部コンテンツの読み込みにより、ページ全体の読み込み速度に影響を与える可能性があります。  

### SEO
- 検索エンジンはiFrame内のコンテンツをインデックスしづらいため、重要な情報をiFrame内に置くのは避けるべきです。  

## 同一オリジンポリシーと制約
ブラウザには**同一オリジンポリシー (Same-Origin Policy)**があり、親ページから別ドメインのiFrame内URLをJavaScriptで直接取得することはできません。  
これは、悪意のあるウェブサイトによる個人情報の盗難を防ぐための仕組みです。

### 例外
- **同一オリジンの場合**: 親ページとiFrameが同じドメイン・プロトコル・ポートを持つ場合、`contentWindow.location.href`でURLを取得できます。  
- **sandbox属性**: `sandbox`が設定されていても、この制限は引き続き適用されます。  
- したがって、iFrame内のページが`postMessage`を使って親ページに自身のURLを通知する仕組みを用意する必要があります。

## Notionページ埋め込み時の注意点
Notionページを非公開にすると、埋め込んだiFrameは以下のような状態になります。

- エラーメッセージが表示される（「コンテンツにアクセスできません」やログイン画面など）  
- 空白表示になり、内容が一切表示されない  

これは、Notionのサーバーがアクセス権をチェックし、公開設定が無効な場合に表示をブロックするためです。  
親ページ側で特別な対策をしない限り、非公開ページはiFrame内に表示できません。

---

※この記事はChatGPTの回答を基に作成しています。

[[E02 OneNoteで発行したURLはiframe埋め込みできる？]]
