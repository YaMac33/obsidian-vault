

```js
// validators.js から isNotEmpty 関数をインポート
import { isNotEmpty } from "../validators.js";

/**
 * 指定日付から日数を加算・減算した日付を返す
 * @param {string} baseDate - YYYY-MM-DD形式の基準日
 * @param {number} days - 加算または減算する日数
 * @returns {string} 計算結果の日付 (YYYY-MM-DD)
 */
export function calculateDate(baseDate, days) {
  // baseDate が空の場合は空文字を返して処理終了
  if (!isNotEmpty(baseDate)) return "";

  // baseDate を Date オブジェクトに変換
  const base = new Date(baseDate);

  // 無効な日付の場合は空文字を返して処理終了
  if (isNaN(base.getTime())) return "";

  // 指定された日数を加算/減算
  base.setDate(base.getDate() + days);

  // 年を取得
  const yyyy = base.getFullYear();

  // 月を取得（0〜11なので +1）、2桁にゼロ埋め
  const mm = String(base.getMonth() + 1).padStart(2, "0");

  // 日を取得、2桁にゼロ埋め
  const dd = String(base.getDate()).padStart(2, "0");

  // YYYY-MM-DD 形式で返す
  return `${yyyy}-${mm}-${dd}`;
}
```

[[A02 JS解説2]]

`import { isNotEmpty } from "../validators.js";` は、

- **`../validators.js`**：一つ上の階層にある `validators.js` というファイルから
    
- **`isNotEmpty`**：名前付きエクスポートされた関数または変数
    

を**読み込む（インポートする）**という意味です。  
→ `validators.js` 内で `export function isNotEmpty(...) { ... }` のように定義されているものを使えるようにします。

`export function calculateDate(baseDate, days) {` は、

- **`calculateDate`**：日付計算を行う関数の名前
    
- **`export`**：この関数を他のファイルからインポートして使えるように公開するキーワード
    

という意味です。  
→「`calculateDate` という関数をモジュールの外でも使えるようにする」という宣言です。

`export function isNotEmpty(value) { return value != null && value.trim().length > 0; }` は、

- **`export`**：この関数を他のファイルから使えるよう公開
    
- **`isNotEmpty`**：引数 `value` が空でないかを判定する関数名
    
- **処理内容**：`value` が `null` または `undefined` でなく、前後の空白を除いた長さが 0 より大きい場合に `true` を返す
    

→「文字列が空でないことを判定して返す関数を外部に公開している」という意味です。

`if (!isNotEmpty(baseDate)) return "";` は、

- **`!isNotEmpty(baseDate)`**：`baseDate` が空である（`isNotEmpty` が `false`）場合
    
- **`return ""`**：空文字列を返して処理を終了
    

→「`baseDate` が空なら、関数をそこで終わらせて空文字を返す」という意味です。

`const base = new Date(baseDate); if (isNaN(base.getTime())) return "";` は、

- **`new Date(baseDate)`**：`baseDate` を日付オブジェクトに変換
    
- **`base.getTime()`**：その日付をミリ秒の数値に変換
    
- **`isNaN(...)`**：変換結果が「数値でない」（=無効な日付）かを判定
    
- **`return ""`**：無効なら空文字を返して処理を終了
    

→「`baseDate` が有効な日付でなければ、空文字を返して終わる」という意味です。

`base.setDate(base.getDate() + days);` は、

- **`base.getDate()`**：`base`（Dateオブジェクト）の日付（1〜31）を取得
    
- **`+ days`**：指定された日数を足す
    
- **`setDate(...)`**：その新しい日付を `base` に設定
    

→「`base` に、現在の日付に `days` を足した日付をセットする」という意味です。

このコードは、`base`（Dateオブジェクト）から「YYYY-MM-DD」形式の文字列を作るための各部分を取り出しています。

- **`base.getFullYear()`**：西暦（例：2025）を取得し、`yyyy` に代入
    
- **`base.getMonth() + 1`**：月を取得（`getMonth()` は0〜11なので +1）、文字列化して2桁に整形し、`mm` に代入
    
- **`base.getDate()`**：日付を取得、同じく2桁に整形して、`dd` に代入
    

→「年・月・日をゼロ埋めした文字列としてそれぞれ準備している」という意味です。

`return \`${yyyy}-${mm}-${dd}`;` は、

- **テンプレートリテラル（バッククォート `` ` ``）**を使って
    
- 変数 `yyyy`, `mm`, `dd` を `${}` で埋め込み
    
- `YYYY-MM-DD` 形式の文字列を作成し返す
    

→「年・月・日を組み合わせた文字列を返す」という意味です。

[[A02 JS解説2]]
